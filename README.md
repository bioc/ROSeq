
<!-- README.md is generated from README.Rmd. Please edit that file -->

# ROSeq - A rank based approach to modeling gene expression

Author: Krishan Gupta

## Introduction

ROSeq - A rank based approach to modeling gene expression with filtered
and normalized read count matrix. Takes in the complete filtered and
normalized read count matrix, the location of the two sub-populations
and the number of cores to be used.

## Installation

The developer version of the R package can be installed with the
following R commands:

install\_github('krishan57gupta/ROSeq')

## Vignette tutorial

This vignette uses a small simulated data, to demonstrate a standard
pipeline. This vignette can be used as a tutorial as well.

## Example

Libraries need to be loaded before running.

``` r
library(ROSeq)
library(compcodeR)
#> Loading required package: sm
#> Package 'sm', version 2.2-5.6: type help(sm) for summary information
library(edgeR)
#> Loading required package: limma
```

``` r
n_samples<-8
n_genes<-80
n_de_genes<-40
mydata <- generateSyntheticData(dataset = "mydata", n.vars = n_genes, samples.per.cond = n_samples, n.diffexp = n_de_genes)
samples<-list()
samples$count<-mydata@count.matrix
samples$group<-mydata@sample.annotations$condition
head(samples$count)
#>    sample1 sample2 sample3 sample4 sample5 sample6 sample7 sample8 sample9
#> g1 1449916  539158 1248248 1549269  993221 1340450 1460754 1361930 2675143
#> g2 5602680  444969 1293654 3973318 1214640 2905207 1156450 3535384 1581247
#> g3 2513556  719402 1604307 1341727 1433891 2143134 1194067 1453123 2062491
#> g4   14476    3064   11591   10473    5716   12259   11417   20312   16573
#> g5    8587    7497    1618   10834    4961    2592    1648    3095   25077
#> g6     291     168     333     318     240     362     337     331     306
#>    sample10 sample11 sample12 sample13 sample14 sample15 sample16
#> g1  2654581  2405603  2228971  1652019  2510233  3051831  1650894
#> g2  1688338  4012571   398422   757974  1688485  1711748   916227
#> g3  2446460  1566289  2021903  2920930  1444039  2416753  2255588
#> g4     7556    16820     7941    10559     8051    12929    17336
#> g5     1480     2747     1529     5291      909     7774    24165
#> g6      207      214      237      188      184      254      274
```

``` r
samples$count=apply(samples$count,2,function(x) as.numeric(x))
gkeep <- apply(samples$count,1,function(x) sum(x>0)>5)
samples$count<-samples$count[gkeep,]
samples$count<-edgeR::cpm(samples$count)
```

``` r
output<-ROSeq(countData=samples$count, condition = samples$group, nbits=0, numCores=1)
```

``` r
output
#>              pVals         pAdj      log2FC    Wald_T        F_a      F_b
#>  [1,] 4.637550e-02 1.002713e-01 -1.05990572  6.141968 -1.7309059 45.67144
#>  [2,] 4.637550e-02 1.002713e-01  0.39553916  6.141968 -1.7309059 45.67144
#>  [3,] 1.000000e+00 1.000000e+00 -0.65290452  0.000000 -1.4106303 50.00000
#>  [4,] 1.000000e+00 1.000000e+00 -0.33980943  0.000000 -1.7309059 45.67144
#>  [5,] 1.000000e+00 1.000000e+00 -0.68047286  0.000000 -0.8994364 40.94644
#>  [6,] 4.637550e-02 1.002713e-01  0.23645721  6.141968 -0.8994364 40.94644
#>  [7,] 1.000000e+00 1.000000e+00 -0.05361747  0.000000 -1.7309059 45.67144
#>  [8,] 1.036419e-05 2.763785e-04  0.38399946 22.954308 -1.4106303 50.00000
#>  [9,] 7.540960e-04 1.206554e-02 -0.98785171 14.379982 -0.9105847 50.00000
#> [10,] 1.000000e+00 1.000000e+00  0.19941523  0.000000 -1.4106303 50.00000
#> [11,] 4.637550e-02 1.002713e-01 -0.18176198  6.141968 -1.7309059 45.67144
#> [12,] 1.000000e+00 1.000000e+00  0.17183084  0.000000 -0.8994364 40.94644
#> [13,] 4.637550e-02 1.002713e-01 -0.32485744  6.141968 -0.8994364 40.94644
#> [14,] 4.637550e-02 1.002713e-01 -0.80469885  6.141968 -0.8994364 40.94644
#> [15,] 2.988297e-02 1.002713e-01  0.77876771  7.020933 -1.4106303 50.00000
#> [16,] 1.000000e+00 1.000000e+00 -0.07626699  0.000000 -1.7309059 45.67144
#> [17,] 2.988297e-02 1.002713e-01  0.45604076  7.020933 -1.4106303 50.00000
#> [18,] 4.637550e-02 1.002713e-01  0.33112942  6.141968 -1.7309059 45.67144
#> [19,] 1.000000e+00 1.000000e+00  0.71897932  0.000000 -1.7309059 45.67144
#> [20,] 4.637550e-02 1.002713e-01  0.29861693  6.141968 -1.7309059 45.67144
#> [21,] 1.000000e+00 1.000000e+00  0.05512313  0.000000 -1.4106303 50.00000
#> [22,] 1.000000e+00 1.000000e+00 -0.38545179  0.000000 -0.8407951 50.00000
#> [23,] 2.988297e-02 1.002713e-01  0.24275504  7.020933 -1.4106303 50.00000
#> [24,] 1.000000e+00 1.000000e+00  0.04720918  0.000000 -1.4106303 50.00000
#> [25,] 2.277580e-02 1.002713e-01  0.02697735  7.564113 -0.5342420 50.00000
#> [26,] 1.000000e+00 1.000000e+00  0.13426673  0.000000 -1.7309059 45.67144
#> [27,] 1.000000e+00 1.000000e+00  0.69094247  0.000000 -1.4106303 50.00000
#> [28,] 1.000000e+00 1.000000e+00  0.22367611  0.000000 -1.0417458 50.00000
#> [29,] 1.000000e+00 1.000000e+00  0.14109218  0.000000 -1.7309059 45.67144
#> [30,] 1.000000e+00 1.000000e+00 -0.64461789  0.000000 -1.7309059 45.67144
#> [31,] 4.637550e-02 1.002713e-01 -0.89603205  6.141968 -1.7309059 45.67144
#> [32,] 1.000000e+00 1.000000e+00  0.50290105  0.000000 -1.4106303 50.00000
#> [33,] 2.988297e-02 1.002713e-01 -0.15104640  7.020933 -1.4106303 50.00000
#> [34,] 1.000000e+00 1.000000e+00 -0.26843241  0.000000 -1.7309059 45.67144
#> [35,] 1.000000e+00 1.000000e+00 -0.29799138  0.000000 -1.4106303 50.00000
#> [36,] 1.000000e+00 1.000000e+00  0.94068344  0.000000 -1.4106303 50.00000
#> [37,] 2.988297e-02 1.002713e-01 -0.44650179  7.020933 -1.4106303 50.00000
#> [38,] 1.000000e+00 1.000000e+00 -0.77601863  0.000000 -1.7309059 45.67144
#> [39,] 1.000000e+00 1.000000e+00  0.41254911  0.000000 -1.7309059 45.67144
#> [40,] 4.637550e-02 1.002713e-01  1.30785055  6.141968 -1.7309059 45.67144
#> [41,] 1.000000e+00 1.000000e+00  1.24701525  0.000000 -1.7309059 45.67144
#> [42,] 1.000000e+00 1.000000e+00  1.34736165  0.000000 -0.8407951 50.00000
#> [43,] 1.000000e+00 1.000000e+00  1.42556057  0.000000 -0.8407951 50.00000
#> [44,] 1.036419e-05 2.763785e-04  2.56909486 22.954308 -1.4106303 50.00000
#> [45,] 2.988297e-02 1.002713e-01  0.66245606  7.020933 -1.4106303 50.00000
#> [46,] 1.000000e+00 1.000000e+00  0.97281447  0.000000 -0.8407951 50.00000
#> [47,] 2.988297e-02 1.002713e-01  1.22831449  7.020933 -1.4106303 50.00000
#> [48,] 1.000000e+00 1.000000e+00  1.24648555  0.000000 -1.4106303 50.00000
#> [49,] 1.000000e+00 1.000000e+00  1.68701306  0.000000 -1.7309059 45.67144
#> [50,] 8.466138e-05 1.693228e-03  1.88246548 18.753702 -0.5103854 50.00000
#> [51,] 1.730833e-03 2.307777e-02  2.58804204 12.718305 -0.3246922 50.00000
#> [52,] 2.988297e-02 1.002713e-01  1.07779242  7.020933 -1.4106303 50.00000
#> [53,] 4.905361e-02 1.032707e-01  1.08612355  6.029683 -0.8407951 50.00000
#> [54,] 2.988297e-02 1.002713e-01  0.99437964  7.020933 -1.4106303 50.00000
#> [55,] 1.000000e+00 1.000000e+00  1.97291270  0.000000 -0.8994364 40.94644
#> [56,] 2.988297e-02 1.002713e-01  1.12669467  7.020933 -0.8407951 50.00000
#> [57,] 2.988297e-02 1.002713e-01  1.22335995  7.020933 -0.8407951 50.00000
#> [58,] 4.637550e-02 1.002713e-01  0.87727394  6.141968 -0.8994364 40.94644
#> [59,] 2.988297e-02 1.002713e-01  1.01920988  7.020933 -0.8407951 50.00000
#> [60,] 1.000000e+00 1.000000e+00  1.46983557  0.000000 -1.4106303 50.00000
#> [61,] 1.000000e+00 1.000000e+00  1.71653021  0.000000 -1.7309059 45.67144
#> [62,] 3.591405e-08 2.873124e-06  1.34488243 34.284275 -1.4106303 50.00000
#> [63,] 1.000000e+00 1.000000e+00  1.04959721  0.000000 -0.8407951 50.00000
#> [64,] 1.000000e+00 1.000000e+00  1.05126990  0.000000 -0.5342420 50.00000
#> [65,] 1.000000e+00 1.000000e+00  1.72450530  0.000000 -1.7309059 45.67144
#> [66,] 4.637550e-02 1.002713e-01  1.25083186  6.141968 -0.8994364 40.94644
#> [67,] 2.884585e-01 5.917098e-01 -0.44766523  2.486408 -0.9105847 50.00000
#> [68,] 1.000000e+00 1.000000e+00  1.19193065  0.000000 -1.7309059 45.67144
#> [69,] 4.637550e-02 1.002713e-01  1.15456050  6.141968 -1.7309059 45.67144
#> [70,] 1.000000e+00 1.000000e+00  0.30539349  0.000000 -1.7309059 45.67144
#> [71,] 1.000000e+00 1.000000e+00  0.76403686  0.000000 -1.4106303 50.00000
#> [72,] 2.988297e-02 1.002713e-01  0.78331485  7.020933 -0.8407951 50.00000
#> [73,] 2.988297e-02 1.002713e-01  1.09867755  7.020933 -1.4106303 50.00000
#> [74,] 1.000000e+00 1.000000e+00  1.17557486  0.000000 -0.8994364 40.94644
#> [75,] 2.988297e-02 1.002713e-01  1.25837297  7.020933 -1.4106303 50.00000
#> [76,] 4.637550e-02 1.002713e-01  0.99374012  6.141968 -0.8994364 40.94644
#> [77,] 1.000000e+00 1.000000e+00  1.22488864  0.000000 -1.7309059 45.67144
#> [78,] 4.637550e-02 1.002713e-01  1.52908023  6.141968 -0.8994364 40.94644
#> [79,] 1.000000e+00 1.000000e+00  0.88417695  0.000000 -1.7309059 45.67144
#> [80,] 1.000000e+00 1.000000e+00  1.38173161  0.000000 -0.8994364 40.94644
#>                 F_A F_n_bins      F_R2         S_a      S_b           S_A
#>  [1,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#>  [2,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#>  [3,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#>  [4,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#>  [5,]  2.241116e-79       80 0.8189160 -0.89943637 40.94644  2.241116e-79
#>  [6,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#>  [7,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#>  [8,] 9.731129e-102      100 0.8597375 -0.32469216 50.00000 3.133359e-101
#>  [9,]  1.709960e-96       80 0.9269172 -1.73090589 45.67144  1.013675e-88
#> [10,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [11,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [12,]  2.241116e-79       80 0.8189160 -0.89943637 40.94644  2.241116e-79
#> [13,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [14,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [15,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [16,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [17,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [18,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [19,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [20,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [21,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [22,] 1.925452e-101      100 0.8282849 -0.84079514 50.00000 1.925452e-101
#> [23,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [24,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [25,] 2.318671e-105      120 0.8539843 -1.04174582 50.00000 1.263103e-105
#> [26,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [27,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [28,] 1.263103e-105      120 0.8695553 -1.04174582 50.00000 1.263103e-105
#> [29,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [30,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [31,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [32,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [33,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [34,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [35,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [36,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [37,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [38,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [39,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [40,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [41,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [42,] 1.925452e-101      100 0.8282849 -0.84079514 50.00000 1.925452e-101
#> [43,] 1.925452e-101      100 0.8282849 -0.84079514 50.00000 1.925452e-101
#> [44,] 9.731129e-102      100 0.8597375 -0.32469216 50.00000 3.133359e-101
#> [45,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [46,] 1.925452e-101      100 0.8282849 -0.84079514 50.00000 1.925452e-101
#> [47,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [48,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [49,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [50,] 2.668127e-101      100 0.9318596  0.50091744 50.00000 5.337078e-101
#> [51,] 3.133359e-101      100 0.8600483  0.50091744 50.00000 5.337078e-101
#> [52,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [53,] 1.925452e-101      100 0.8282849 -0.32469216 50.00000 3.133359e-101
#> [54,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [55,]  2.241116e-79       80 0.8189160 -0.89943637 40.94644  2.241116e-79
#> [56,] 1.925452e-101      100 0.8282849 -1.41063033 50.00000 9.731129e-102
#> [57,] 1.925452e-101      100 0.8282849 -1.41063033 50.00000 9.731129e-102
#> [58,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [59,] 1.925452e-101      100 0.8282849 -1.41063033 50.00000 9.731129e-102
#> [60,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [61,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [62,] 9.731129e-102      100 0.8597375 -0.01666259 50.00000 3.951217e-101
#> [63,] 1.925452e-101      100 0.8282849 -0.84079514 50.00000 1.925452e-101
#> [64,] 2.318671e-105      120 0.8539843 -0.53424200 50.00000 2.318671e-105
#> [65,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [66,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [67,]  1.709960e-96       80 0.9269172 -0.89943637 40.94644  2.241116e-79
#> [68,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [69,]  1.013675e-88       80 0.8383513 -0.89943637 40.94644  2.241116e-79
#> [70,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [71,] 9.731129e-102      100 0.8597375 -1.41063033 50.00000 9.731129e-102
#> [72,] 1.925452e-101      100 0.8282849 -1.41063033 50.00000 9.731129e-102
#> [73,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [74,]  2.241116e-79       80 0.8189160 -0.89943637 40.94644  2.241116e-79
#> [75,] 9.731129e-102      100 0.8597375 -0.84079514 50.00000 1.925452e-101
#> [76,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [77,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [78,]  2.241116e-79       80 0.8189160 -1.73090589 45.67144  1.013675e-88
#> [79,]  1.013675e-88       80 0.8383513 -1.73090589 45.67144  1.013675e-88
#> [80,]  2.241116e-79       80 0.8189160 -0.89943637 40.94644  2.241116e-79
#>       S_n_bins      S_R2
#>  [1,]       80 0.8189160
#>  [2,]       80 0.8189160
#>  [3,]      100 0.8597375
#>  [4,]       80 0.8383513
#>  [5,]       80 0.8189160
#>  [6,]       80 0.8383513
#>  [7,]       80 0.8383513
#>  [8,]      100 0.8600483
#>  [9,]       80 0.8383513
#> [10,]      100 0.8597375
#> [11,]       80 0.8189160
#> [12,]       80 0.8189160
#> [13,]       80 0.8383513
#> [14,]       80 0.8383513
#> [15,]      100 0.8282849
#> [16,]       80 0.8383513
#> [17,]      100 0.8282849
#> [18,]       80 0.8189160
#> [19,]       80 0.8383513
#> [20,]       80 0.8189160
#> [21,]      100 0.8597375
#> [22,]      100 0.8282849
#> [23,]      100 0.8282849
#> [24,]      100 0.8597375
#> [25,]      120 0.8695553
#> [26,]       80 0.8383513
#> [27,]      100 0.8597375
#> [28,]      120 0.8695553
#> [29,]       80 0.8383513
#> [30,]       80 0.8383513
#> [31,]       80 0.8189160
#> [32,]      100 0.8597375
#> [33,]      100 0.8282849
#> [34,]       80 0.8383513
#> [35,]      100 0.8597375
#> [36,]      100 0.8597375
#> [37,]      100 0.8282849
#> [38,]       80 0.8383513
#> [39,]       80 0.8383513
#> [40,]       80 0.8189160
#> [41,]       80 0.8383513
#> [42,]      100 0.8282849
#> [43,]      100 0.8282849
#> [44,]      100 0.8600483
#> [45,]      100 0.8282849
#> [46,]      100 0.8282849
#> [47,]      100 0.8282849
#> [48,]      100 0.8597375
#> [49,]       80 0.8383513
#> [50,]      100 0.9771997
#> [51,]      100 0.9771997
#> [52,]      100 0.8282849
#> [53,]      100 0.8600483
#> [54,]      100 0.8282849
#> [55,]       80 0.8189160
#> [56,]      100 0.8597375
#> [57,]      100 0.8597375
#> [58,]       80 0.8383513
#> [59,]      100 0.8597375
#> [60,]      100 0.8597375
#> [61,]       80 0.8383513
#> [62,]      100 0.9624210
#> [63,]      100 0.8282849
#> [64,]      120 0.8539843
#> [65,]       80 0.8383513
#> [66,]       80 0.8383513
#> [67,]       80 0.8189160
#> [68,]       80 0.8383513
#> [69,]       80 0.8189160
#> [70,]       80 0.8383513
#> [71,]      100 0.8597375
#> [72,]      100 0.8597375
#> [73,]      100 0.8282849
#> [74,]       80 0.8189160
#> [75,]      100 0.8282849
#> [76,]       80 0.8383513
#> [77,]       80 0.8383513
#> [78,]       80 0.8383513
#> [79,]       80 0.8383513
#> [80,]       80 0.8189160
```
