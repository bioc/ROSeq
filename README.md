
<!-- README.md is generated from README.Rmd. Please edit that file -->

# ROSeq - A rank based approach to modeling gene expression

Author: Krishan Gupta

## Introduction

ROSeq - A rank based approach to modeling gene expression with filtered
and normalized read count matrix. Takes in the complete filtered and
normalized read count matrix, the location of the two sub-populations
and the number of cores to be used.

## Installation

The developer version of the R package can be installed with the
following R commands:

install\_github(“krishan57gupta/ROSeq”)

## Vignette tutorial

This vignette uses a small simulated data, to demonstrate a standard
pipeline. This vignette can be used as a tutorial as well.

## Example

Libraries need to be loaded before running.

``` r
library(ROSeq)
library(compcodeR)
#> Loading required package: sm
#> Warning in fun(libname, pkgname): couldn't connect to display ":0"
#> Package 'sm', version 2.2-5.6: type help(sm) for summary information
library(edgeR)
#> Loading required package: limma
```

``` r
n_samples<-8
n_genes<-80
n_de_genes<-40
mydata <- generateSyntheticData(dataset = "mydata", n.vars = n_genes, samples.per.cond = n_samples, n.diffexp = n_de_genes)
samples<-list()
samples$count<-mydata@count.matrix
samples$group<-mydata@sample.annotations$condition
head(samples$count)
#>    sample1 sample2 sample3 sample4 sample5 sample6 sample7 sample8 sample9
#> g1   11296   14340   11015   21625   16858   18247   20015   22616   20731
#> g2   13005    7526    7230   16311     240    1830     998    4575    5040
#> g3   29582   34711   45909   30390   33247   46264   70522   58392   72622
#> g4 1808925 1215813 1442711 1109069 1741961 2098947 2210180 1291718  866330
#> g5      35     134    4906     457     467    2447     648    9267    1258
#> g6      85     524     267     154    1765     915    1757      19     389
#>    sample10 sample11 sample12 sample13 sample14 sample15 sample16
#> g1    21771    17265    19771    11668    21014    34795    30823
#> g2      566     2501     3310     1839     3988    16139     2407
#> g3    94857   103858    91799    67173    60360    91394   103429
#> g4  1004212  1700946  1699536  1021331  1135644  1951854  1864722
#> g5     1788     2893       51     1493       65      110     1029
#> g6      201      617     1448     1070      883     2037      552
```

``` r
samples$count=apply(samples$count,2,function(x) as.numeric(x))
gkeep <- apply(samples$count,1,function(x) sum(x>0)>5)
samples$count<-samples$count[gkeep,]
samples$count<-edgeR::cpm(samples$count)
```

``` r
output<-ROSeq(countData=samples$count, condition = samples$group, nbits=0, numCores=1)
```

``` r
output
#>              pVals        pAdj      log2FC
#>  [1,] 1.000000e+00 1.000000000 -0.55227883
#>  [2,] 1.000000e+00 1.000000000  0.48296670
#>  [3,] 2.884585e-01 0.490993211 -1.15896151
#>  [4,] 4.637550e-02 0.106001133  0.04598581
#>  [5,] 1.000000e+00 1.000000000  0.91136255
#>  [6,] 4.637550e-02 0.106001133 -0.62019357
#>  [7,] 1.000000e+00 1.000000000 -0.83021908
#>  [8,] 1.000000e+00 1.000000000 -0.76213427
#>  [9,] 2.988297e-02 0.106001133 -1.46631601
#> [10,] 1.000000e+00 1.000000000  0.36319091
#> [11,] 1.000000e+00 1.000000000  0.38796666
#> [12,] 1.000000e+00 1.000000000 -1.46950586
#> [13,] 1.000000e+00 1.000000000  0.08065383
#> [14,] 1.000000e+00 1.000000000 -0.08990433
#> [15,] 1.000000e+00 1.000000000 -0.71995383
#> [16,] 2.988297e-02 0.106001133  0.11656721
#> [17,] 2.553986e-04 0.006810630  0.05954176
#> [18,] 1.000000e+00 1.000000000 -0.00937932
#> [19,] 1.000000e+00 1.000000000 -0.39088611
#> [20,] 2.988297e-02 0.106001133  0.22020330
#> [21,] 2.948188e-01 0.491364718 -0.13741649
#> [22,] 1.000000e+00 1.000000000 -0.89288528
#> [23,] 2.988297e-02 0.106001133  0.23616682
#> [24,] 8.558477e-02 0.175558508 -0.29637466
#> [25,] 1.000000e+00 1.000000000  0.08565197
#> [26,] 8.558477e-02 0.175558508 -0.44982555
#> [27,] 1.000000e+00 1.000000000 -1.12647149
#> [28,] 1.000000e+00 1.000000000  0.17663909
#> [29,] 4.637550e-02 0.106001133 -1.23411676
#> [30,] 2.803249e-01 0.490993211 -1.77008802
#> [31,] 2.988297e-02 0.106001133 -0.14817286
#> [32,] 4.637550e-02 0.106001133 -0.69834864
#> [33,] 1.000000e+00 1.000000000 -0.11237588
#> [34,] 2.988297e-02 0.106001133  0.13118970
#> [35,] 2.988297e-02 0.106001133 -1.33504808
#> [36,] 2.884585e-01 0.490993211  0.71590862
#> [37,] 1.000000e+00 1.000000000  0.01210603
#> [38,] 2.803249e-01 0.490993211  0.41463375
#> [39,] 1.000000e+00 1.000000000  0.07636475
#> [40,] 1.000000e+00 1.000000000 -0.09564122
#> [41,] 4.637550e-02 0.106001133  1.03225179
#> [42,] 4.637550e-02 0.106001133  0.90261373
#> [43,] 4.637550e-02 0.106001133  1.63659895
#> [44,] 1.000000e+00 1.000000000  0.89177573
#> [45,] 2.988297e-02 0.106001133  1.12894648
#> [46,] 1.000000e+00 1.000000000  0.63611605
#> [47,] 2.277580e-02 0.106001133  0.93042290
#> [48,] 7.540960e-04 0.012065535  1.33363638
#> [49,] 2.988297e-02 0.106001133  0.89350629
#> [50,] 1.000000e+00 1.000000000  0.85966920
#> [51,] 2.988297e-02 0.106001133  1.08057668
#> [52,] 2.988297e-02 0.106001133  1.03842208
#> [53,] 8.558477e-02 0.175558508  0.64446042
#> [54,] 4.637550e-02 0.106001133  0.85566911
#> [55,] 2.803249e-01 0.490993211 -0.70646099
#> [56,] 4.637550e-02 0.106001133  0.91624333
#> [57,] 5.399796e-05 0.002182115  0.91678210
#> [58,] 4.905361e-02 0.109008013  1.24045944
#> [59,] 2.988297e-02 0.106001133  0.43565987
#> [60,] 2.884585e-01 0.490993211  0.59774596
#> [61,] 1.000000e+00 1.000000000  0.61191111
#> [62,] 7.540960e-04 0.012065535  0.31569042
#> [63,] 4.637550e-02 0.106001133  1.12936990
#> [64,] 1.000000e+00 1.000000000  1.10267396
#> [65,] 2.988297e-02 0.106001133  0.36518942
#> [66,] 4.637550e-02 0.106001133  0.14524809
#> [67,] 1.000000e+00 1.000000000  1.25735744
#> [68,] 2.884585e-01 0.490993211  2.61952429
#> [69,] 4.637550e-02 0.106001133  0.77399017
#> [70,] 1.000000e+00 1.000000000  0.95619647
#> [71,] 1.000000e+00 1.000000000  1.08390457
#> [72,] 5.455286e-05 0.002182115  1.17436054
#> [73,] 2.803249e-01 0.490993211  0.72756218
#> [74,] 1.000000e+00 1.000000000  0.73382784
#> [75,] 1.000000e+00 1.000000000  0.84258261
#> [76,] 4.637550e-02 0.106001133  1.16937549
#> [77,] 2.988297e-02 0.106001133  0.95156896
#> [78,] 4.637550e-02 0.106001133  1.22627014
#> [79,] 2.988297e-02 0.106001133  0.71988999
#> [80,] 1.000000e+00 1.000000000  0.47416246
```
