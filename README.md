
<!-- README.md is generated from README.Rmd. Please edit that file -->

# ROSeq - A rank based approach to modeling gene expression

Author: Krishan Gupta

## Introduction

ROSeq - A rank based approach to modeling gene expression with filtered
and normalized read count matrix. Takes in the complete filtered and
normalized read count matrix, the location of the two sub-populations
and the number of cores to be used.

## Installation

The developer version of the R package can be installed with the
following R commands:

install\_github(“krishan57gupta/ROSeq”)

## Vignette tutorial

This vignette uses a small simulated data, to demonstrate a standard
pipeline. This vignette can be used as a tutorial as well.

## Example

Libraries need to be loaded before running.

``` r
library(ROSeq)
library(compcodeR)
#> Loading required package: sm
#> Warning in fun(libname, pkgname): couldn't connect to display ":0"
#> Package 'sm', version 2.2-5.6: type help(sm) for summary information
library(edgeR)
#> Loading required package: limma
```

``` r
n_samples<-8
n_genes<-80
n_de_genes<-40
mydata <- generateSyntheticData(dataset = "mydata", n.vars = n_genes, samples.per.cond = n_samples, n.diffexp = n_de_genes)
samples<-list()
samples$count<-mydata@count.matrix
samples$group<-mydata@sample.annotations$condition
head(samples$count)
#>    sample1 sample2 sample3 sample4 sample5 sample6 sample7 sample8 sample9
#> g1  131586   83273   43621   88049   52198   69853   87658   68883   86351
#> g2  161905  177764  264232  298845  158754  198698  185008  210346  219037
#> g3  133383   60317   89826   49792   42928   39914   39359   97133   37082
#> g4       0       4       0    3541       0     458       0    2150    9868
#> g5   24472   29660   56303   22868   28175   44377   21740   32881   18495
#> g6    8769   14500    7832   17006    6177    7533   22901    7837   21480
#>    sample10 sample11 sample12 sample13 sample14 sample15 sample16
#> g1    29276    94023    36581    65487    62841    83924    31959
#> g2    99003   235673   191388   215353   145312   152421   101414
#> g3    42314   115356    63218   112027    85924    40408    54724
#> g4    11205     6678     3504        0     4633    26349        0
#> g5    38763    63324    75226    48626    18390    48853    10095
#> g6    14147     8109    13492    23603    12567    11794     9467
```

``` r
samples$count=apply(samples$count,2,function(x) as.numeric(x))
gkeep <- apply(samples$count,1,function(x) sum(x>0)>5)
samples$count<-samples$count[gkeep,]
samples$count<-edgeR::cpm(samples$count)
```

``` r
output<-ROSeq(countData=samples$count, condition = samples$group, nbits=0, numCores=1)
```

``` r
output
#>              pVals         pAdj      log2FC
#>  [1,] 2.988297e-02 0.0853799173  0.32949065
#>  [2,] 4.637550e-02 0.0904887721  0.26708768
#>  [3,] 4.637550e-02 0.0904887721 -0.08556226
#>  [4,] 1.717100e-07 0.0000137368 -3.52417200
#>  [5,] 4.637550e-02 0.0904887721 -0.21172701
#>  [6,] 1.000000e+00 1.0000000000 -0.34093302
#>  [7,] 2.884585e-01 0.5128151310 -0.87549075
#>  [8,] 1.000000e+00 1.0000000000 -0.24641696
#>  [9,] 4.637550e-02 0.0904887721 -0.94407201
#> [10,] 1.000000e+00 1.0000000000 -0.09861174
#> [11,] 7.540960e-04 0.0049865362 -1.35272305
#> [12,] 2.988297e-02 0.0853799173 -0.58550367
#> [13,] 1.000000e+00 1.0000000000 -0.69864046
#> [14,] 1.000000e+00 1.0000000000  0.45086887
#> [15,] 1.000000e+00 1.0000000000 -0.46932788
#> [16,] 5.455286e-05 0.0008728458 -0.11540063
#> [17,] 1.000000e+00 1.0000000000  0.31980009
#> [18,] 2.553986e-04 0.0022702099 -0.31735353
#> [19,] 1.000000e+00 1.0000000000 -1.11391659
#> [20,] 1.000000e+00 1.0000000000 -0.18451397
#> [21,] 2.988297e-02 0.0853799173 -0.82036547
#> [22,] 1.000000e+00 1.0000000000  0.11681963
#> [23,] 1.000000e+00 1.0000000000  0.17350646
#> [24,] 2.988297e-02 0.0853799173 -0.43678948
#> [25,] 2.988297e-02 0.0853799173 -0.28695656
#> [26,] 2.988297e-02 0.0853799173 -0.21172728
#> [27,] 2.988297e-02 0.0853799173 -0.69832745
#> [28,] 1.000000e+00 1.0000000000 -0.59865554
#> [29,] 4.637550e-02 0.0904887721  0.45839257
#> [30,] 1.000000e+00 1.0000000000 -0.43316998
#> [31,] 2.884585e-01 0.5128151310 -0.47508247
#> [32,] 1.036419e-05 0.0002763785 -0.11637514
#> [33,] 2.884585e-01 0.5128151310 -0.11268262
#> [34,] 1.000000e+00 1.0000000000 -0.29996182
#> [35,] 2.137105e-04 0.0022702099 -0.32619232
#> [36,] 4.637550e-02 0.0904887721 -0.88852674
#> [37,] 4.637550e-02 0.0904887721 -2.02225420
#> [38,] 8.103121e-04 0.0049865362 -0.08273160
#> [39,] 4.637550e-02 0.0904887721 -0.29864594
#> [40,] 2.988297e-02 0.0853799173 -1.05650429
#> [41,] 7.540960e-04 0.0049865362  0.91928017
#> [42,] 1.000000e+00 1.0000000000  1.55667735
#> [43,] 1.000000e+00 1.0000000000  0.14802508
#> [44,] 1.000000e+00 1.0000000000  0.57653739
#> [45,] 5.399796e-05 0.0008728458  0.86374792
#> [46,] 5.847200e-07 0.0000233888  1.01847183
#> [47,] 1.000000e+00 1.0000000000  0.80906903
#> [48,] 1.000000e+00 1.0000000000  1.05027649
#> [49,] 1.000000e+00 1.0000000000  1.77477257
#> [50,] 4.637550e-02 0.0904887721  1.06464013
#> [51,] 1.000000e+00 1.0000000000  1.62966298
#> [52,] 4.637550e-02 0.0904887721  1.29093785
#> [53,] 4.637550e-02 0.0904887721  1.57024523
#> [54,] 2.988297e-02 0.0853799173  0.35217753
#> [55,] 1.000000e+00 1.0000000000  1.01078667
#> [56,] 1.527887e-04 0.0020371823  0.94674383
#> [57,] 7.200425e-02 0.1371509501  1.03520817
#> [58,] 1.000000e+00 1.0000000000  1.09255971
#> [59,] 2.988297e-02 0.0853799173  1.02703656
#> [60,] 1.000000e+00 1.0000000000  1.55099578
#> [61,] 1.000000e+00 1.0000000000  0.74735892
#> [62,] 2.988297e-02 0.0853799173  0.66135023
#> [63,] 2.988297e-02 0.0853799173  0.63427749
#> [64,] 2.988297e-02 0.0853799173  0.81091115
#> [65,] 2.553986e-04 0.0022702099  0.97381140
#> [66,] 2.988297e-02 0.0853799173  0.86893981
#> [67,] 7.540960e-04 0.0049865362  0.26739722
#> [68,] 2.988297e-02 0.0853799173  0.63449522
#> [69,] 1.000000e+00 1.0000000000  1.06250885
#> [70,] 1.000000e+00 1.0000000000  0.47153638
#> [71,] 1.000000e+00 1.0000000000  0.74546877
#> [72,] 4.637550e-02 0.0904887721  0.91315993
#> [73,] 1.000000e+00 1.0000000000  1.21482200
#> [74,] 1.000000e+00 1.0000000000  0.84496515
#> [75,] 1.000000e+00 1.0000000000  1.10998902
#> [76,] 1.000000e+00 1.0000000000  1.27384969
#> [77,] 1.000000e+00 1.0000000000  0.36559557
#> [78,] 1.000000e+00 1.0000000000  0.45438442
#> [79,] 1.000000e+00 1.0000000000  1.12443298
#> [80,] 4.637550e-02 0.0904887721  0.72791555
```
